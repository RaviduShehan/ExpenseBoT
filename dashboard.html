<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ExpenseBoT - Dashboard</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
  <style>
    body { font-family: Arial; padding:20px; background:#f4f4f4;}
    .container { max-width:600px; margin:auto; background:#fff; padding:20px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.2);}
    button { padding:10px 20px; background:#007bff; color:white; border:none; border-radius:5px; cursor:pointer; }
    button:hover { background:#0056b3; }
  </style>
</head>
<body>

<div class="container">
  <h2>Dashboard</h2>
  <p>Welcome, <span id="username"></span></p>
  <button id="logoutBtn">Logout</button>

  <h3>Add Expense</h3>
  <form id="expenseForm">
    <input type="text" id="desc" placeholder="Description" required>
    <input type="number" id="amount" placeholder="Amount" required>
    <select id="type">
      <option>Expense</option>
      <option>Income</option>
      <option>Credit Card</option>
      <option>Withdrawal</option>
    </select>
    <input type="text" id="category" placeholder="Category" required>
    <select id="paidFrom">
      <option>cash</option>
      <option>cd</option>
      <option>bank</option>
    </select>
    <button type="submit">Add Entry</button>
  </form>

  <h3><a href="summary.html">Go to Summary</a></h3>
</div>

<script>
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  auth.onAuthStateChanged(user => {
    if(!user) {
      window.location.href = "index.html";
    } else {
      db.collection('users').doc(user.uid).get().then(doc => {
        document.getElementById('username').innerText = doc.data().name || user.displayName;
      });
    }
  });

  document.getElementById('logoutBtn').addEventListener('click', () => {
    auth.signOut().then(()=> window.location.href="index.html");
  });

  // Add expense
  document.getElementById('expenseForm').addEventListener('submit', e => {
    e.preventDefault();
    const user = auth.currentUser;
    db.collection('expenses').doc(user.uid).collection('entries').add({
      date: new Date(),
      description: document.getElementById('desc').value,
      amount: parseFloat(document.getElementById('amount').value),
      type: document.getElementById('type').value,
      category: document.getElementById('category').value,
      paid_from: document.getElementById('paidFrom').value,
      source: user.uid
    }).then(() => {
      alert('Expense Added!');
      document.getElementById('expenseForm').reset();
    }).catch(err => console.error(err));
  });
</script>

</body>
</html>
